---
title: "Next.js 13 App routerì— Google Analytics ì ìš©í•˜ê¸°"
date: '2023-09-08'
tags: ['next', 'google-analytics', 'app-router', 'layout']
draft: false
summary: "ì•„ì§ Next13ì— Google Analyticsë¥¼ ì ìš©í•œ ê²½ìš°ê°€ ì—†ëŠ”ì§€ ìë£Œê°€ ë¶€ì‹¤í–ˆë‹¤. ê·¸ë˜ì„œ ì§ì ‘ ì •ë¦¬í•œ ë‚´ìš©"
---

ê°œì¸ ë¸”ë¡œê·¸ ì‘ì—…ì´ ê±°ì˜ ë§ˆë¬´ë¦¬ ë‹¨ê³„ê°€ ë˜ì–´ê°€ê³  ìˆë‹¤. ê·¸ë¦¬ê³  ì˜¤ëŠ˜ì€ `Google Analytics`ë¥¼ ì ìš©í•´ë³´ë ¤ê³  í•œë‹¤.

ì ìš© ë°©ë²•ì€ ë§í¬ë¥¼ ë”°ë¼ ê°€ë©´ ìì„¸í•˜ê²Œ ì„¤ëª…ì´ ë˜ì–´ ìˆì–´ì„œ ë”°ë¼í•˜ë©´ ëœë‹¤.

[ğŸ“Œ ì‚¬ì´íŠ¸ì— ì• ë„ë¦¬í‹±ìŠ¤ ì‚¬ìš©í•˜ê¸° ğŸ“Œ](https://support.google.com/sites/answer/97459?hl=ko)

ë‹¤ë§Œ `Next`ì— ì§ì ‘ ì ìš©í•˜ëŠ”ë° ì‚´ì§ ì–´ë ¤ì›€ì´ ìˆì—ˆë‹¤.

ì¼ë‹¨, ìœ„ì˜ ë§í¬ë¥¼ ë”°ë¼í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ `script`ë¥¼ êµ¬ê¸€ì—ì„œ ì•Œë ¤ì¤€ë‹¤.

```html
<!-- Google tag (gtag.js) -->
<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-xxxxxxxxx"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'G-xxxxxxxxx');
</script>
```

ìœ„ì˜ ì½”ë“œë¥¼ ì´ì œ `Next` `head`ì— ì ìš©í•˜ê¸°ë§Œ í•˜ë©´ ëì´ë‹¤.

ëª¨ë“  í˜ì´ì§€ì—ì„œ ìœ„ì˜ ìŠ¤í¬ë¦½íŠ¸ê°€ í˜¸ì¶œë˜ì–´ì•¼ í•˜ë¯€ë¡œ ì¼ë‹¨ ë‚˜ëŠ” `RootLayout`ì— ì ìš©í•˜ê¸°ë¡œ ë§ˆìŒ ë¨¹ì—ˆë‹¤.

ì•„ë˜ëŠ” ë‚´ê°€ ì‘ì„± ë° ì ìš©í•œ ì½”ë“œì´ë‹¤.

ë¨¼ì € ìœ„ì˜ ì½”ë“œë¥¼ í¬í•¨í•œ `Client` ì»´í¬ë„ŒíŠ¸ë¥¼ í•˜ë‚˜ ë§Œë“¤ì—ˆë‹¤.

```tsx
// Analytics.tsx
'use client';

import Script from 'next/script';

export default function Analytics() {
  return (
    <>
      <Script
        async
        src={`https://www.googletagmanager.com/gtag/js?id=${process.env.NEXT_PUBLIC_GA_ID}`}
        strategy='afterInteractive'
      />
      <Script id='google-analytics' strategy='afterInteractive'>
        {`window.dataLayer = window.dataLayer || []; 
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '${process.env.NEXT_PUBLIC_GA_ID}');
          `}
      </Script>
    </>
  );
}
```

ê·¸ë¦¬ê³  `RootLayout`ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ ì ìš©í–ˆë‹¤.

```tsx
//layout.tsx
export default function RootLayout({ children }: IPropsChildren) {
  return (
    <html lang='kr'>
      <Analytics />
      <QueryProviders>
        <body className={sans.className}>
          <Header menus={menus} />
          <div className='w-full flex flex-col items-center'>
            <section className='w-full max-w-[1192px] flex flex-row justify-center'>
              {children}
              <TagBox />
            </section>
          </div>
        </body>
      </QueryProviders>
    </html>
  );
}
```

ê·¸ë¦¬ê³  `head`ì— ì •ìƒì ìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¬ì–´ì¡ŒëŠ”ì§€ í™•ì¸í•´ë³´ì

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º](https://github.com/nostrss/next13-blog/assets/56717167/c3d3f794-6489-4aee-b51a-5625aa65c6a0)

> ì •ìƒ!!

ì´ì œ ë°°í¬ í›„ êµ¬ê¸€ì• ë„ë¦¬í‹±ìŠ¤ì™€ í†µì‹ ì´ ë˜ë©´ ëë‚˜ê²Œ ëœë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º](https://github.com/nostrss/next13-blog/assets/56717167/61f28805-b367-4beb-9e9f-1a4b3e1ca8a6)

ëª¨ë“ ê²Œ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì´ì œ êµ¬ê¸€ì• ë„ë¦¬í‹±ìŠ¤ê°€ ë‚´ ë¸”ë¡œê·¸ë¡œ ì ‘ì†í•˜ëŠ” ìœ ì €ë“¤ì˜ í†µê³„ë¥¼ ìˆ˜ì§‘í•´ ì¤„ ê²ƒì´ë‹¤.
